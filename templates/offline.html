<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Hors ligne — BWHITE DIGITAL</title>
        <meta name="theme-color" content="#16a34a" />
        <style>
    :root{
      --brand-300:#86efac; --brand-400:#4ade80; --brand-600:#16a34a; --brand-700:#15803d; --brand-900:#14532d;
      --bg-900:#0b1020; --bg-800:#111827; --card:#0f172acc; --text:#e5e7eb; --muted:#94a3b8; --danger:#ef4444;
      --ring: color-mix(in srgb, var(--brand-600) 25%, transparent);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      color:var(--text);
      background:
        radial-gradient(800px 420px at 10% 0%, color-mix(in srgb, var(--brand-700) 22%, transparent) 0%, transparent 60%),
        radial-gradient(700px 360px at 100% 10%, color-mix(in srgb, #06b6d4 18%, transparent) 0%, transparent 65%),
        linear-gradient(135deg, var(--bg-800) 0%, var(--bg-900) 55%, #050a14 100%);
      display:grid; place-items:center; padding:24px;
    }
    .wrap{max-width:520px; width:100%}
    .card{
      background:var(--card); backdrop-filter:blur(10px);
      border:1px solid color-mix(in srgb, var(--brand-600) 28%, rgba(255,255,255,.06));
      border-radius:16px; padding:28px; box-shadow:0 20px 60px rgba(0,0,0,.45);
      animation:fadeIn .4s ease-out;
    }
    .logo{
      width:84px;height:84px;border-radius:18px;margin:0 auto 16px;
      background:linear-gradient(135deg,var(--brand-600),var(--brand-700));
      display:grid;place-items:center; box-shadow:0 10px 30px color-mix(in srgb, var(--brand-700) 40%, transparent);
    }
    h1{margin:0 0 6px;font-size:24px;letter-spacing:.2px;text-align:center}
    p.lead{margin:0 0 18px;color:var(--muted);text-align:center}
    .status{
      display:inline-flex;align-items:center;gap:8px;
      font-size:12px;color:#d1fae5;background:color-mix(in srgb, var(--brand-700) 22%, transparent);
      border:1px solid color-mix(in srgb, var(--brand-600) 40%, transparent);
      padding:6px 10px;border-radius:999px
    }
    .grid{display:grid;gap:12px;margin-top:18px}
    .btn{
      width:100%;display:inline-flex;align-items:center;justify-content:center;gap:10px;
      padding:12px 14px;border-radius:10px;border:1px solid transparent;text-decoration:none;
      color:#fff;background:linear-gradient(135deg,var(--brand-600),var(--brand-700));
      box-shadow:0 8px 24px color-mix(in srgb, var(--brand-700) 35%, transparent);
      cursor:pointer; transition:filter .15s ease, transform .15s ease;
    }
    .btn:hover{filter:brightness(1.05); transform:translateY(-1px)}
    .btn.secondary{
      background:transparent;border-color:color-mix(in srgb, var(--brand-600) 38%, rgba(255,255,255,.12));
      color:var(--text)
    }
    .hint{margin-top:14px;color:var(--muted);font-size:12px;text-align:center}
    .meta{margin-top:16px;display:grid;gap:8px;font-size:12px;color:var(--muted)}
    .row{display:flex;justify-content:space-between;gap:10px}
    .err{color:var(--danger)}
    svg{display:block}
    @keyframes fadeIn{from{opacity:0; transform:translateY(-10px)} to{opacity:1; transform:translateY(0)}}
    @media (prefers-reduced-motion:reduce){.card{animation:none}}
        </style>
    </head>
    <body>
        <div class="wrap">
            <div class="card" role="status" aria-live="polite">
                <div class="logo" aria-hidden="true">
                    <!-- bouclier -->
                    <svg width="34"
                         height="34"
                         viewBox="0 0 24 24"
                         fill="none"
                         aria-hidden="true">
                        <path d="M12 3l7 3v5c0 5-3.5 9-7 10-3.5-1-7-5-7-10V6l7-3Z" fill="white" fill-opacity=".12" />
                        <path d="M12 21c-3.5-1-7-5-7-10V6l7-3m0 18c3.5-1 7-5 7-10V6l-7-3m0 0v18" stroke="white" stroke-opacity=".9" stroke-width="1.2" />
                        <path d="M8.5 12.5l2.2 2.2 4.8-4.8" stroke="#ffffff" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </div>
                <h1>BWHITE DIGITAL</h1>
                <p class="lead">Vous êtes hors connexion. Certaines fonctionnalités sont indisponibles.</p>
                <div style="text-align:center">
                    <span id="pill" class="status">
                        <svg width="14" height="14" viewBox="0 0 24 24" aria-hidden="true">
                            <circle cx="12" cy="12" r="6" fill="#ef4444"></circle>
                        </svg>
                        <span id="state-text">Hors ligne</span>
                    </span>
                </div>
                <div class="grid">
                    <button id="retry"
                            class="btn"
                            type="button"
                            aria-label="Réessayer la connexion">
                        <!-- refresh -->
                        <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                            <path fill="#fff" d="M12 6V3L8 7l4 4V8a4 4 0 1 1-3.39 2h-2.1A6 6 0 1 0 12 6z" />
                        </svg>
                        Réessayer
                    </button>
                    <a href="/" class="btn secondary" aria-label="Aller à l'accueil">
                        <!-- home -->
                        <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                            <path fill="currentColor" d="m12 3 9 8h-3v9h-5v-6H11v6H6v-9H3l9-8z" />
                        </svg>
                        Accueil
                    </a>
                </div>
                <div class="meta" id="meta">
                    <div class="row">
                        <span>Dernier essai</span><span id="ts">—</span>
                    </div>
                    <div class="row">
                        <span>État</span><span id="net">offline</span>
                    </div>
                    <div class="row">
                        <span>Type réseau</span><span id="rtt">n/a</span>
                    </div>
                    <div class="row">
                        <span>Cache</span><span id="cache">PWA/Service Worker requis</span>
                    </div>
                    <div id="err" class="row err" hidden>
                        <span>Erreur</span><span id="errmsg"></span>
                    </div>
                </div>
                <p class="hint">Astuce&nbsp;: vérifiez votre connexion ou réessayez. La page se recharge dès que le réseau revient.</p>
                <noscript>
                    <p class="hint err">JavaScript est requis pour la détection de l’état réseau.</p>
                </noscript>
            </div>
        </div>
        <script>
    (function(){
      const stateText = document.getElementById('state-text');
      const pill = document.getElementById('pill');
      const ts = document.getElementById('ts');
      const net = document.getElementById('net');
      const rtt = document.getElementById('rtt');
      const cache = document.getElementById('cache');
      const errRow = document.getElementById('err');
      const errMsg = document.getElementById('errmsg');

      function fmtDate(d){ return new Intl.DateTimeFormat('fr-FR',{dateStyle:'short', timeStyle:'medium'}).format(d); }

      function paint(){
        const online = navigator.onLine;
        stateText.textContent = online ? 'En ligne' : 'Hors ligne';
        pill.querySelector('circle')?.setAttribute('fill', online ? '#22c55e' : '#ef4444');
        net.textContent = online ? 'online' : 'offline';
        ts.textContent = fmtDate(new Date());
        const c = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
        rtt.textContent = c ? `${c.effectiveType || 'n/a'} · ~${c.rtt||'—'}ms` : 'n/a';
        cache.textContent = (typeof window.caches !== 'undefined' && 'serviceWorker' in navigator)
          ? 'Disponible si pré-caché'
          : 'PWA/Service Worker requis';
      }

      async function retry(){
        errRow.hidden = true; errMsg.textContent = '';
        paint();
        if (navigator.onLine) {
          // petit délai pour laisser le réseau stabiliser
          setTimeout(() => location.reload(), 300);
          return;
        }
        // tentative légère: HEAD sur la racine si possible
        try{
          const ctrl = new AbortController();
          setTimeout(()=>ctrl.abort(), 4000);
          const res = await fetch('/', { method:'HEAD', cache:'no-store', signal:ctrl.signal });
          if (res.ok) location.reload();
          else { errMsg.textContent = `HTTP ${res.status}`; errRow.hidden = false; }
        }catch(e){
          errMsg.textContent = e.name === 'AbortError' ? 'Délai dépassé' : (e.message||'Erreur réseau');
          errRow.hidden = false;
        }finally{ paint(); }
      }

      window.addEventListener('online',  () => { paint(); setTimeout(()=>location.reload(), 300); });
      window.addEventListener('offline', paint);

      document.getElementById('retry').addEventListener('click', retry);
      paint();
    })();
        </script>
    </body>
</html>
